/************************************************************************/

DROP TABLE AUTHOR IF EXISTS;

CREATE TABLE AUTHOR (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    FIRST_NAME VARCHAR(40) NOT NULL,
    MIDDLE_NAME VARCHAR(40) NULL,
    LAST_NAME VARCHAR(50) NOT NULL,
    CONSTRAINT IDX_AUTHOR_ID PRIMARY KEY (ID)
);

/************************************************************************/

DROP TABLE BOOK IF EXISTS;

CREATE TABLE BOOK (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    AUTHOR_ID INTEGER NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    CONSTRAINT IDX_BOOK_ID PRIMARY KEY (ID),
    CONSTRAINT FK_AUTHOR FOREIGN KEY (AUTHOR_ID) REFERENCES AUTHOR(ID)
);

/************************************************************************/

DROP TABLE CHAPTER_BOOK IF EXISTS;

CREATE TABLE CHAPTER_BOOK (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    BOOK_ID INTEGER NOT NULL,
    NUMBER INTEGER NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    CONSTRAINT IDX_CHAPTER_BOOK_ID PRIMARY KEY (ID),
    CONSTRAINT FK_BOOK FOREIGN KEY (BOOK_ID) REFERENCES BOOK(ID) 
);

/************************************************************************/

DROP TABLE LEVEL IF EXISTS;

CREATE TABLE LEVEL (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    CONSTRAINT IDX_LEVEL_ID PRIMARY KEY (ID),
    CONSTRAINT UQ_NAME UNIQUE (NAME)
);

/************************************************************************/

DROP TABLE EXERCISE_BASE IF EXISTS;

CREATE TABLE EXERCISE_BASE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    EXERCISE_BASE_TYPE INTEGER NOT NULL,
    POSITION_ORDER INTEGER NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    PATTERN_FILE_NAME VARCHAR(40) NULL,
    CONSTRAINT IDX_EXERCISE_BASE_ID PRIMARY KEY (ID)
);

/************************************************************************/

DROP TABLE EXERCISE_LEVEL_BASE IF EXISTS;

CREATE TABLE EXERCISE_LEVEL_BASE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    LEVEL_ID INTEGER NOT NULL,
    EXERCISE_BASE_ID INTEGER NOT NULL,
    VELOCITY INTEGER NULL,
    SOUND_FILE_NAME VARCHAR(40) NULL,
    CONSTRAINT IDX_EXERCISE_LEVEL_ID PRIMARY KEY (ID),
    CONSTRAINT FK_LEVEL FOREIGN KEY (LEVEL_ID) REFERENCES LEVEL(ID),
    CONSTRAINT FK_EXERCISE FOREIGN KEY (EXERCISE_BASE_ID) REFERENCES EXERCISE_BASE(ID)
);

/************************************************************************/

DROP TABLE EXERC_LEV_CHAP_BOOK IF EXISTS;

CREATE TABLE EXERC_LEV_CHAP_BOOK (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    CHAPTER_BOOK_ID INTEGER NOT NULL,
    EXERCISE_LEVEL_BASE_ID INTEGER NOT NULL,
    CONSTRAINT IDX_EXERC_LEV_CHAP_BOOK PRIMARY KEY (ID),
    CONSTRAINT FK_CHAPTER_BOOK FOREIGN KEY (CHAPTER_BOOK_ID) REFERENCES CHAPTER_BOOK(ID),
    CONSTRAINT FK_EXERCISE_LEVEL_BASE FOREIGN KEY (EXERCISE_LEVEL_BASE_ID) REFERENCES EXERCISE_LEVEL_BASE(ID) 
);

/************************************************************************/

DROP TABLE ROUTINE_BASE IF EXISTS;

CREATE TABLE ROUTINE_BASE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    NAME VARCHAR(40) NOT NULL,
    CONSTRAINT IDX_ROUTINE_BASE_ID PRIMARY KEY (ID)
);

/************************************************************************/

DROP TABLE ROUTINE_BASE_EXERCISE_BASE IF EXISTS;

CREATE TABLE ROUTINE_BASE_EXERCISE_BASE (
    ID INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) NOT NULL,
    ROUTINE_BASE_ID INTEGER NOT NULL,
    EXERCISE_LEVEL_BASE_ID INTEGER NOT NULL,
    POSITION_ORDER INTEGER NOT NULL,
    CONSTRAINT IDX_ROUTINE_BASE_EXERCISE_BASE_ID PRIMARY KEY (ID),
    CONSTRAINT FK_ROUTINE_BASE FOREIGN KEY (ROUTINE_BASE_ID) REFERENCES ROUTINE_BASE(ID),
    CONSTRAINT FK_EXERCISE_LEVEL_BASE2 FOREIGN KEY (EXERCISE_LEVEL_BASE_ID) REFERENCES EXERCISE_LEVEL_BASE(ID)
);
